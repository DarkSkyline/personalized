<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimation and Validation Methods for Subgroup Identification and
    Personalized Medicine • personalized</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">personalized</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/usage_of_the_personalized_package.html">Vignette</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<div id="overview-of-personalized" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#overview-of-personalized" class="anchor"></a>Overview of ‘personalized’</h1></div>
<p>The ‘personalized’ package is designed for the analysis of data where the effect of a treatment or intervention may vary for different patients. It can be used for either data from randomized controlled trials or observational studies and is not limited specifically to the analysis of medical data.</p>
<p>The personalized package provides estimation methods for subgroup identification under the framework of <a href="http://onlinelibrary.wiley.com/doi/10.1111/biom.12676/abstract">Chen et al (2017)</a>. It also provides routines for valid estimation of the subgroup-specific treatment effects.</p>
<p><img src="articles/usage_overview-1.png" width="100%"></p>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<p><a href="http://jaredhuling.org/personalized/">Documentation</a></p>
<ul>
<li><p><a href="http://jaredhuling.org/personalized/articles/usage_of_the_personalized_package.html">Tutorial / Vignette</a> - tutorial of statistical methodology and usage of the package</p></li>
<li><p><a href="http://jaredhuling.org/personalized/reference/index.html">Function help files</a></p></li>
</ul>
</div>
</div>
<div id="installing-the-personalized-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-the-personalized-package" class="anchor"></a>Installing the ‘personalized’ package</h1>
<p>Install from CRAN using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"personalized"</span>)</code></pre></div>
<p>or install the development version using the <strong>devtools</strong> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"jaredhuling/personalized"</span>)</code></pre></div>
<p>or by cloning and building using <code>R CMD INSTALL</code></p>
</div>
<div id="quick-usage-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#quick-usage-overview" class="anchor"></a>Quick Usage Overview</h1>
<p>Load the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(personalized)</code></pre></div>
<div id="create-a-propensity-score-model" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-propensity-score-model" class="anchor"></a>Create a propensity score model</h3>
<p>(it should be a function which inputs covariates and treatments and returns propensity score):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prop.func &lt;-<span class="st"> </span><span class="cf">function</span>(x, trt)
{
    <span class="co"># fit propensity score model</span>
    propens.model &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(<span class="dt">y =</span> trt,
                               <span class="dt">x =</span> x, <span class="dt">family =</span> <span class="st">"binomial"</span>)
    pi.x &lt;-<span class="st"> </span><span class="kw">predict</span>(propens.model, <span class="dt">s =</span> <span class="st">"lambda.min"</span>,
                    <span class="dt">newx =</span> x, <span class="dt">type =</span> <span class="st">"response"</span>)[,<span class="dv">1</span>]
    pi.x
}</code></pre></div>
</div>
<div id="fit-a-model-to-estimate-subgroup" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-a-model-to-estimate-subgroup" class="anchor"></a>Fit a model to estimate subgroup:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subgrp.model &lt;-<span class="st"> </span><span class="kw"><a href="reference/fit.subgroup.html">fit.subgroup</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y,
                             <span class="dt">trt =</span> trt,
                             <span class="dt">propensity.func =</span> prop.func,
                             <span class="dt">loss   =</span> <span class="st">"sq_loss_lasso"</span>,
                             <span class="dt">nfolds =</span> <span class="dv">5</span>)              <span class="co"># option for cv.glmnet</span></code></pre></div>
</div>
<div id="display-estimated-subgroups-and-variables-selected-which-determine-the-subgroups" class="section level3">
<h3 class="hasAnchor">
<a href="#display-estimated-subgroups-and-variables-selected-which-determine-the-subgroups" class="anchor"></a>Display estimated subgroups and variables selected which determine the subgroups:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(subgrp.model)</code></pre></div>
<pre><code>## family:  gaussian 
## loss:    sq_loss_lasso 
## method:  weighting 
## propensity 
## function: propensity.func 
## 
## Average Outcomes:
##                 Recommended Ctrl    Recommended Trt
## Received Ctrl  -5.6613 (n = 117) -23.6003 (n = 114)
## Received Trt  -20.9028 (n = 132)  -7.3036 (n = 137)
## 
## Ctrl effect among recommended Ctrl   Trt effect among recommended Trt 
##                  15.2414 (n = 249)                  16.2968 (n = 251) 
## 
## Benefit score quantiles: 
##        0%       25%       50%       75%      100% 
## -14.15602  -3.58120   0.04648   3.51676  14.78106 
## 
## 9 out of 50 variables selected in total by the lasso (cross validation criterion).
## 
##     Estimate
## Trt   0.3389
## V2    1.3120
## V11  -0.8576
## V17  -0.3681
## V32   0.2421
## V35   0.3570
## V39  -0.1401
## V40   0.0275
## V45   0.0945
## V50  -0.0422</code></pre>
</div>
<div id="use-repeated-train-and-test-splitting-to-estimate-subgroup-treatment-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#use-repeated-train-and-test-splitting-to-estimate-subgroup-treatment-effects" class="anchor"></a>Use repeated train and test splitting to estimate subgroup treatment effects:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">val.model &lt;-<span class="st"> </span><span class="kw"><a href="reference/validate.subgroup.html">validate.subgroup</a></span>(subgrp.model, <span class="dt">B =</span> <span class="dv">100</span>,
                               <span class="dt">method =</span> <span class="st">"training_test"</span>,
                               <span class="dt">train.fraction =</span> <span class="fl">0.75</span>)</code></pre></div>
</div>
<div id="display-estimated-subgroup-treatment-effects" class="section level3">
<h3 class="hasAnchor">
<a href="#display-estimated-subgroup-treatment-effects" class="anchor"></a>Display estimated subgroup treatment effects:</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(val.model, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">sample.pct =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## family:  gaussian 
## loss:    sq_loss_lasso 
## method:  weighting 
## 
## validation method:  training_test_replication 
## iterations:  100 
## 
## Average Test Set Outcomes:
##                         Recommended Ctrl            Recommended Trt
## Received Ctrl  -9.18 (SE = 6.83, 20.74%) -19.97 (SE = 6.14, 25.81%)
## Received Trt  -16.35 (SE = 5.66, 24.18%) -13.03 (SE = 5.67, 29.26%)
## 
## Ctrl effect among recommended Ctrl   Trt effect among recommended Trt 
##           7.17 (SE = 10.5, 44.93%)           6.94 (SE = 8.96, 55.07%)</code></pre>
<p>Visualize subgroup-specific treatment effect estimates across training/testing iterations:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(val.model)</code></pre></div>
<p><img src="articles/vis_val-1.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div id="investigate-the-marginal-characteristics-of-the-two-estimated-subgroups" class="section level3">
<h3 class="hasAnchor">
<a href="#investigate-the-marginal-characteristics-of-the-two-estimated-subgroups" class="anchor"></a>Investigate the marginal characteristics of the two estimated subgroups</h3>
<p>Here we only display covariates with a significantly different mean value (at level 0.05)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/summarize.subgroups.html">summarize.subgroups</a></span>(subgrp.model, <span class="dt">p.value =</span> <span class="fl">0.05</span>)</code></pre></div>
<pre><code>##     Avg (recom Ctrl) Avg (recom Trt) Ctrl - Trt pval Ctrl - Trt
## V1          0.266492       -0.057653   0.324146       2.147e-01
## V2         -1.899413        1.870326  -3.769739       6.746e-55
## V3          0.033790        0.123058  -0.089268       7.378e-01
## V4          0.134217        0.217828  -0.083611       7.619e-01
## V5         -0.082638       -0.300738   0.218100       3.866e-01
## V6          0.173496       -0.029785   0.203281       4.567e-01
## V7         -0.002880       -0.132264   0.129384       6.261e-01
## V8          0.088475       -0.062135   0.150610       5.740e-01
## V9         -0.038066       -0.242125   0.204059       4.478e-01
## V10        -0.119139        0.013597  -0.132736       6.219e-01
## V11         1.239408       -1.121597   2.361005       1.325e-21
## V12         0.200841        0.104925   0.095917       7.264e-01
## V13         0.070726       -0.265149   0.335875       2.235e-01
## V14        -0.014771       -0.183628   0.168857       5.129e-01
## V15         0.112392        0.206887  -0.094494       7.140e-01
## V16        -0.225112       -0.029797  -0.195315       4.836e-01
## V17         0.956636       -0.652966   1.609602       3.814e-09
## V18        -0.161601        0.102548  -0.264149       3.517e-01
## V19        -0.114320       -0.065134  -0.049186       8.524e-01
## V20        -0.301426       -0.094245  -0.207180       4.323e-01
## V21         0.151313        0.099241   0.052072       8.421e-01
## V22         0.036973        0.025914   0.011059       9.684e-01
## V23        -0.061897        0.383565  -0.445462       8.684e-02
## V24         0.059496       -0.083219   0.142715       5.985e-01
## V25        -0.124776       -0.333858   0.209082       4.444e-01
## V26        -0.171079       -0.126225  -0.044854       8.672e-01
## V27         0.179029        0.198470  -0.019441       9.426e-01
## V28         0.017898        0.030955  -0.013057       9.612e-01
## V29         0.006661        0.179831  -0.173170       5.230e-01
## V30        -0.021850        0.042430  -0.064280       8.090e-01
## V31         0.427910       -0.060331   0.488241       7.183e-02
## V32        -0.499087        0.174704  -0.673791       9.574e-03
## V33        -0.161684       -0.138999  -0.022685       9.342e-01
## V34        -0.031119       -0.286260   0.255141       3.502e-01
## V35        -0.717008        0.464186  -1.181194       1.356e-05
## V36         0.017353        0.051908  -0.034555       8.970e-01
## V37        -0.086710       -0.128919   0.042209       8.697e-01
## V38         0.003970       -0.117545   0.121515       6.553e-01
## V39         0.309017       -0.355246   0.664264       1.700e-02
## V40        -0.428111       -0.024037  -0.404074       1.226e-01
## V41         0.171776       -0.028166   0.199942       4.722e-01
## V42        -0.257506       -0.114546  -0.142960       5.872e-01
## V43        -0.293105        0.378708  -0.671814       1.706e-02
## V44        -0.119815        0.036825  -0.156640       5.348e-01
## V45        -0.274946        0.042420  -0.317366       2.423e-01
## V46         0.053626       -0.031523   0.085149       7.542e-01
## V47        -0.027894        0.004777  -0.032671       9.030e-01
## V48         0.109658        0.169670  -0.060012       8.180e-01
## V49        -0.086639       -0.083815  -0.002824       9.920e-01
## V50         0.049473       -0.279293   0.328767       2.440e-01
##     SE (recom Ctrl) SE (recom Trt)
## V1           0.1874         0.1815
## V2           0.1469         0.1536
## V3           0.1800         0.1966
## V4           0.1937         0.1963
## V5           0.1780         0.1780
## V6           0.2019         0.1836
## V7           0.1869         0.1883
## V8           0.1827         0.1956
## V9           0.1901         0.1898
## V10          0.1935         0.1868
## V11          0.1753         0.1577
## V12          0.1975         0.1898
## V13          0.1933         0.1965
## V14          0.1758         0.1887
## V15          0.1750         0.1891
## V16          0.2053         0.1883
## V17          0.1989         0.1800
## V18          0.2111         0.1891
## V19          0.1844         0.1893
## V20          0.1913         0.1813
## V21          0.1924         0.1767
## V22          0.1896         0.2045
## V23          0.1818         0.1853
## V24          0.1928         0.1902
## V25          0.1931         0.1932
## V26          0.1999         0.1786
## V27          0.1930         0.1887
## V28          0.1797         0.1993
## V29          0.1861         0.1970
## V30          0.1923         0.1835
## V31          0.1986         0.1839
## V32          0.1715         0.1941
## V33          0.1986         0.1899
## V34          0.1975         0.1883
## V35          0.1825         0.1973
## V36          0.1918         0.1853
## V37          0.1699         0.1930
## V38          0.1972         0.1875
## V39          0.1906         0.2016
## V40          0.1791         0.1902
## V41          0.1997         0.1933
## V42          0.1939         0.1779
## V43          0.2091         0.1872
## V44          0.1756         0.1810
## V45          0.1870         0.1963
## V46          0.1871         0.1972
## V47          0.1857         0.1933
## V48          0.1769         0.1914
## V49          0.2010         0.1953
## V50          0.1952         0.2033</code></pre>
</div>
<div id="accessing-help-files-for-main-functions-of-personalized" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-help-files-for-main-functions-of-personalized" class="anchor"></a>Accessing Help Files for Main Functions of <code>personalized</code>
</h2>
<p>Access help files for the main functions of the <code>personalized</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="reference/fit.subgroup.html">?fit.subgroup
?validate.subgroup</a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=personalized">https://​cran.r-project.org/​package=personalized</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jaredhuling/personalized/issues">https://​github.com/​jaredhuling/​personalized/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jared Huling <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=personalized"><img src="http://www.r-pkg.org/badges/version/personalized" alt="version"></a></li>
<li><a href="https://travis-ci.org/jaredhuling/personalized"><img src="https://travis-ci.org/jaredhuling/personalized.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://codecov.io/gh/jaredhuling/personalized"><img src="https://codecov.io/gh/jaredhuling/personalized/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="http://cran.rstudio.com/web/packages/personalized/index.html"><img src="http://cranlogs.r-pkg.org/badges/personalized"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
